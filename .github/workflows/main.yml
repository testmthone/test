# main.yml dosyasının son ve doğru hali

name: Deploy Project - FINAL

on:
  push:
    branches: [ main, master ]

jobs:
  deploy:
    runs-on: self-hosted
    
    steps:
      # Adım 1: Kodu indirir (ve 'test' adında bir alt klasör oluşturur)
      - name: Checkout Repository Code
        uses: actions/checkout@v4

      # Adım 2: Proje dosyalarının olduğu doğru klasöre gir ve betiği çalıştır
      - name: Run Deployment Script
        run: |
          # ÖNCE DOĞRU KLASÖRE GİRİYORUZ
          cd test
          
          echo "🚀 Deployment betiği çalıştırılıyor..."
          
          # Artık doğru klasörde olduğumuz için bu komutlar çalışacaktır
          chmod +x deploy.sh
          ./deploy.sh
          
          echo "✅ Deployment script'i tamamlandı."